<h1 style="text-align: center;"><span style="color: #008000; font-size: 14pt;"><strong><span style="font-family: verdana, geneva;"><span style="color: #0000ff;">R -</span> 3D Plot</span></strong></span></h1>
<p style="text-align: justify;"><span style="font-size: 12pt; font-family: verdana, geneva;">There are many functions in R programming for creating 3D plots. In this section, we will discuss on the&nbsp;<span style="color: #ff0000;"><code>persp()</code></span>&nbsp;function which can be used to create 3D surfaces in perspective view.</span></p>
<p style="text-align: justify;"><strong><span style="font-size: 12pt; font-family: verdana, geneva;">Syntax</span></strong></p>
<pre><span style="font-size: 12pt; font-family: verdana, geneva;"><code>persp(x, y, z)</code></span></pre>
<p style="text-align: justify;"><span style="font-size: 12pt; font-family: verdana, geneva;"><code>x</code>&nbsp;and&nbsp;<code>y</code>&nbsp;are&nbsp;vectors&nbsp;defining the location along x- and y-axis. </span></p>
<p style="text-align: justify;"><span style="font-size: 12pt; font-family: verdana, geneva;">The height of the surface (z-axis) will be in the matrix&nbsp;<code>z</code>.</span></p>
<p style="text-align: justify;"><span style="font-size: 13pt;"><strong><span style="font-family: verdana, geneva;">Example:</span></strong></span></p>
<p style="text-align: justify;"><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">fdejong &lt;- function (x, y) {</span><br /><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">return (x^2 + y^2)</span><br /><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">}</span><br /><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">x &lt;- seq(-10, 10, length= 30)</span><br /><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">y &lt;- x</span><br /><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">z &lt;- outer(x, y, fdejong)</span><br /><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">z[is.na(z)] &lt;- 1</span></p>
<p style="text-align: justify;"><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">persp(x, y, z,)</span></p>
<p style="text-align: justify;">&nbsp;</p>
<p style="text-align: justify;"><span style="font-size: 13pt;"><strong><span style="font-family: verdana, geneva;">Result -</span></strong></span><span style="font-size: 12pt; font-family: verdana, geneva;"><img style="display: block; margin-left: auto; margin-right: auto;" src="3d1.png" width="397" height="397" /></span></p>
<h2 style="text-align: center;"><span style="font-size: 14pt; font-family: verdana, geneva; color: #0000ff;">Adding Titles and Labeling Axes to Plot</span></h2>
<p style="text-align: justify;"><span style="font-size: 12pt; font-family: verdana, geneva;">We can add a title to our plot with the parameter&nbsp;<span style="color: #ff00ff;"><code>main</code>.</span></span></p>
<p style="text-align: justify;"><span style="font-size: 12pt; font-family: verdana, geneva;">Similarly,&nbsp;<span style="color: #ff00ff;"><code>xlab</code>,</span>&nbsp;<span style="color: #ff00ff;"><code>ylab</code></span>&nbsp;and&nbsp;<code>zlab</code>&nbsp;can be used to label the three axes.</span></p>
<h2 style="text-align: justify;"><span style="font-size: 12pt; font-family: verdana, geneva;">Rotational angles</span></h2>
<p style="text-align: justify;"><span style="font-size: 12pt; font-family: verdana, geneva;">We can define the viewing direction using parameters&nbsp;<span style="color: #ff00ff;"><code>theta</code></span>&nbsp;and&nbsp;<span style="color: #ff00ff;"><code>phi</code>.</span></span></p>
<p style="text-align: justify;"><span style="font-size: 12pt; font-family: verdana, geneva;">By default&nbsp;<code>theta</code>, azimuthal direction, is 0 and&nbsp;<code>phi</code>, colatitude direction, is 15.</span></p>
<h2 style="text-align: justify;"><span style="font-size: 12pt; font-family: verdana, geneva;">Coloring and Shading Plot</span></h2>
<p style="text-align: justify;"><span style="font-size: 12pt; font-family: verdana, geneva;">Coloring of the plot is done with parameter&nbsp;<span style="color: #ff00ff;"><code>col</code>.</span></span></p>
<p style="text-align: justify;"><span style="font-size: 12pt; font-family: verdana, geneva;">Similarly, we can add shading with the parameter&nbsp;<span style="color: #ff00ff;"><code>shade</code>.</span></span></p>
<p style="text-align: justify;"><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">fdejong &lt;- function (x, y) {</span><br /><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">return (x^2 + y^2)</span><br /><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">}</span><br /><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">x &lt;- seq(-10, 10, length= 30)</span><br /><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">y &lt;- x</span><br /><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">z &lt;- outer(x, y, fdejong)</span><br /><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">z[is.na(z)] &lt;- 1</span></p>
<p style="text-align: justify;"><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">persp(x, y, z,</span><br /><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">main="Perspective Plot of a Cone",</span><br /><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">zlab = "Height",</span><br /><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">theta = 31, phi = 25,</span><br /><span style="font-size: 12pt; font-family: terminal, monaco; color: #008000;">col = "green", shade = 0.8)</span></p>
<p style="text-align: justify;"><strong><span style="font-size: 12pt; font-family: verdana, geneva;">Result -</span></strong></p>
<p><span style="font-size: 12pt; font-family: verdana, geneva;"><img style="display: block; margin-left: auto; margin-right: auto;" src="3d2.png" width="355" height="355" /></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-size: 12pt;">You can also use the Lattice&nbsp;<strong><span style="color: #ff00ff;"><code>wireframe</code></span></strong>&nbsp;function.</span></p>
<pre class="lang-r prettyprint prettyprinted"><span style="font-size: 12pt; font-family: terminal, monaco;"><code><span class="pln"><span style="font-family: terminal, monaco;">fdejong </span></span><span style="font-family: terminal, monaco;"><span class="pun">&lt;-</span> <span class="kwd">function</span> <span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">)</span> <span class="pun">{</span>
   <span class="kwd">return</span> <span class="pun">(</span><span class="pln">x</span><span class="pun">^</span><span class="lit">2</span> <span class="pun">+</span><span class="pln"> y</span><span class="pun">^</span><span class="lit">2</span><span class="pun">)</span>
<span class="pun">}</span><span class="pln">

x </span><span class="pun">&lt;-</span><span class="pln"> seq</span><span class="pun">(</span><span class="lit">-10</span><span class="pun">,</span> <span class="lit">10</span><span class="pun">,</span><span class="pln"> length</span><span class="pun">=</span> <span class="lit">30</span><span class="pun">)</span><span class="pln">
y </span><span class="pun">&lt;-</span><span class="pln"> x
z </span><span class="pun">&lt;-</span><span class="pln"> outer</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> fdejong</span><span class="pun">)</span><span class="pln">
z</span><span class="pun">[</span><span class="pln">is.na</span><span class="pun">(</span><span class="pln">z</span><span class="pun">)]</span> <span class="pun">&lt;-</span> <span class="lit">1</span><span class="pln">

require</span><span class="pun">(</span><span class="pln">lattice</span><span class="pun">)</span><span class="pln">
wireframe</span><span class="pun">(</span><span class="pln">z</span><span class="pun">,</span><span class="pln"> drape</span><span class="pun">=</span><span class="pln">T</span><span class="pun">,</span><span class="pln"> col.regions</span><span class="pun">=</span><span class="pln">rainbow</span><span class="pun">(</span><span class="lit">100</span><span class="pun">))</span></span></code></span><br /><br /><span style="font-size: 13pt;"><strong>Result-</strong></span><br /><span style="font-size: 12pt;"><img style="display: block; margin-left: auto; margin-right: auto;" src="3d3.png" alt="lattice wireframe color plot" width="496" height="317" /></span></pre>